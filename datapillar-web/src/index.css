/**
 * Tailwind CSS 入口文件
 *
 * 样式优先级配置（通过 @layer）：
 * 1. theme: Tailwind 主题变量
 * 2. antd: Ant Design 组件样式（低优先级，方便覆盖）
 * 3. components: 自定义组件样式
 * 4. utilities: Tailwind 原子类（最高优先级）
 */
@import "tailwindcss";

/* Tailwind v4 Dark Mode 配置：使用 class 策略 */
@variant dark (.dark &);

/* PC 专用断点与容器断点（1080 / 1440 / 1920 / 2560 / 3840） */
@theme {
  --breakpoint-md: 1080px;
  --breakpoint-lg: 1440px;
  --breakpoint-xl: 1920px;
  --breakpoint-2xl: 2560px;
  --breakpoint-3xl: 3840px;

  /* 容器查询断点与屏幕保持一致，便于 @md/@xl 容器写法 */
  --container-md: 1080px;
  --container-lg: 1440px;
  --container-xl: 1920px;
  --container-2xl: 2560px;
  --container-3xl: 3840px;
}

/* 配置样式层级顺序 */
@layer theme, antd, components, utilities;

@layer theme {
  html,
  body,
  #root {
    width: 100%;
    min-height: 100%;
    margin: 0;
    padding: 0;
  }

  html {
    font-size: calc(16px * var(--ui-scale));
  }

  body {
    min-height: 100dvh;
    background-color: #020617;
    overflow-x: hidden;
    overflow-y: auto;
  }

  /* Shimmer 动画 - 光泽划过效果 */
  @keyframes shimmer {
    0% {
      background-position: 100% 50%;
    }
    50% {
      background-position: 0% 50%;
    }
    100% {
      background-position: 100% 50%;
    }
  }

  #root {
    min-height: inherit;
  }

  :root {
    --ui-scale: 1;
    --font-family-sans: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    --font-display: 700 calc(28px * var(--ui-scale)) / calc(34px * var(--ui-scale)) var(--font-family-sans);
    --font-title: 700 calc(22px * var(--ui-scale)) / calc(28px * var(--ui-scale)) var(--font-family-sans);
    --font-heading: 600 calc(18px * var(--ui-scale)) / calc(24px * var(--ui-scale)) var(--font-family-sans);
    --font-subtitle: 600 calc(16px * var(--ui-scale)) / calc(22px * var(--ui-scale)) var(--font-family-sans);
    --font-body: 500 calc(14px * var(--ui-scale)) / calc(20px * var(--ui-scale)) var(--font-family-sans);
    --font-body-sm: 500 calc(13px * var(--ui-scale)) / calc(18px * var(--ui-scale)) var(--font-family-sans);
    --font-caption: 500 calc(12px * var(--ui-scale)) / calc(16px * var(--ui-scale)) var(--font-family-sans);
    --font-micro: 600 calc(10px * var(--ui-scale)) / calc(14px * var(--ui-scale)) var(--font-family-sans);
    --font-context-menu-title: 600 calc(8px * var(--ui-scale)) / calc(10px * var(--ui-scale)) var(--font-family-sans);
  }

  @media (max-width: 1536px) {
    :root {
      --ui-scale: 0.95;
    }
  }

  @media (width >= 1920px) {
    :root {
      --font-context-menu-title: 600 calc(9px * var(--ui-scale)) / calc(11px * var(--ui-scale)) var(--font-family-sans);
    }
  }
}

@layer components {
  body {
    cursor: default;
  }

  button,
  a,
  summary,
  [role='button'],
  [type='button'],
  [type='submit'],
  [type='reset'] {
    cursor: pointer;
  }

  input,
  textarea,
  select,
  [contenteditable='true'] {
    cursor: text;
  }

  input::selection,
  textarea::selection,
  select::selection,
  [contenteditable='true']::selection {
    background: rgba(99, 102, 241, 0.25);
    color: #0f172a;
  }

  .dark input::selection,
  .dark textarea::selection,
  .dark select::selection,
  .dark [contenteditable='true']::selection {
    background: rgba(129, 140, 248, 0.35);
    color: #f8fafc;
  }

  button:disabled,
  [aria-disabled='true'],
  [data-disabled='true'] {
    cursor: not-allowed;
  }

  .scrollbar-invisible {
    scrollbar-width: none;
  }

  .scrollbar-invisible::-webkit-scrollbar {
    width: 0;
    height: 0;
  }

  .custom-scrollbar {
    scrollbar-width: thin;
    scrollbar-color: #cbd5f5 transparent;
  }

  .custom-scrollbar::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  .custom-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb {
    background-color: rgba(99, 102, 241, 0.35);
    border-radius: 999px;
  }

  .dark .custom-scrollbar {
    scrollbar-color: #1b1e28 transparent;
  }

  .dark .custom-scrollbar::-webkit-scrollbar-thumb {
    background-color: #1b1e28;
    box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.05);
  }

  /* Typography Tokens */
  .text-display {
    font: var(--font-display);
  }

  .text-title {
    font: var(--font-title);
  }

  .text-heading {
    font: var(--font-heading);
  }

  .text-subtitle {
    font: var(--font-subtitle);
  }

  .text-body {
    font: var(--font-body);
  }

  .text-body-sm {
    font: var(--font-body-sm);
  }

  .text-caption {
    font: var(--font-caption);
  }

  .text-micro {
    font: var(--font-micro);
  }

  .context-menu-title {
    font: var(--font-context-menu-title);
  }

  /* 扩展字体刻度 */
  .text-legal {
    font: 600 calc(11px * var(--ui-scale)) / calc(14px * var(--ui-scale)) var(--font-family-sans);
  }

  .text-nano {
    font: 600 calc(9px * var(--ui-scale)) / calc(12px * var(--ui-scale)) var(--font-family-sans);
  }

  .text-tiny {
    font: 600 calc(8px * var(--ui-scale)) / calc(10px * var(--ui-scale)) var(--font-family-sans);
  }

  .text-mini {
    font: 600 calc(7px * var(--ui-scale)) / calc(9px * var(--ui-scale)) var(--font-family-sans);
  }

  .text-display-sm {
    font: 700 calc(26px * var(--ui-scale)) / calc(32px * var(--ui-scale)) var(--font-family-sans);
  }

  /* 面板宽度（响应式侧边栏） */
  .w-panel-responsive {
    width: calc(320px * var(--ui-scale));
    @media (width >= 1440px) {
      width: calc(400px * var(--ui-scale));
    }
    @media (width >= 1920px) {
      width: calc(420px * var(--ui-scale));
    }
    @media (width >= 2560px) {
      width: calc(480px * var(--ui-scale));
    }
  }

  /* 左侧导航栏宽度（响应式） */
  .w-sidebar-responsive {
    width: calc(240px * var(--ui-scale));
    @media (width >= 1920px) {
      width: calc(280px * var(--ui-scale));
    }
    @media (width >= 2560px) {
      width: calc(320px * var(--ui-scale));
    }
  }

  /* Minimap 组件专用样式（支持 CSS 变量动态字体） */
  .minimap-code {
    font-size: var(--minimap-font-size, 12px);
    line-height: 1;
    white-space: pre;
  }

  .minimap-line {
    height: var(--minimap-font-size, 12px);
  }

  /* 抽屉宽度（详情面板/侧边抽屉） */
  .w-drawer-responsive {
    width: 480px;
    @media (width >= 1440px) {
      width: 540px;
    }
    @media (width >= 1920px) {
      width: 600px;
    }
    @media (width >= 2560px) {
      width: 680px;
    }
  }

  /* 表格最小宽度（横向滚动表格） */
  .min-w-table-wide {
    min-width: 900px;
  }

  @keyframes orbit-clockwise {
    from {
      transform: rotate(0deg) translateX(48px) rotate(0deg);
    }
    to {
      transform: rotate(360deg) translateX(48px) rotate(-360deg);
    }
  }

  @keyframes orbit-counterclockwise {
    from {
      transform: rotate(0deg) translateX(48px) rotate(0deg);
    }
    to {
      transform: rotate(-360deg) translateX(48px) rotate(360deg);
    }
  }

  .animate-orbit-clockwise {
    animation: orbit-clockwise 4s linear infinite;
  }

  .animate-orbit-counterclockwise {
    animation: orbit-counterclockwise 4s linear infinite;
  }

  @keyframes fade-in {
    from {
      opacity: 0;
      transform: translateY(8px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fade-in {
    animation: fade-in 0.3s ease-out;
  }

  /* Monaco Editor 行号区域边框 */
  .monaco-editor .margin {
    border-right: 1px solid #e2e8f0;
  }

  .dark .monaco-editor .margin {
    border-right: 1px solid #334155;
  }
}

/* 覆盖浏览器 autofill 样式 */
input:-webkit-autofill,
input:-webkit-autofill:hover,
input:-webkit-autofill:focus,
input:-webkit-autofill:active {
  -webkit-box-shadow: 0 0 0 30px transparent inset !important;
  box-shadow: 0 0 0 30px transparent inset !important;
  -webkit-text-fill-color: inherit !important;
  transition: background-color 5000s ease-in-out 0s;
}

/* 深色主题下的 autofill 样式 */
.dark input:-webkit-autofill,
.dark input:-webkit-autofill:hover,
.dark input:-webkit-autofill:focus,
.dark input:-webkit-autofill:active {
  -webkit-box-shadow: 0 0 0 30px #1f2937 inset !important;
  box-shadow: 0 0 0 30px #1f2937 inset !important;
  -webkit-text-fill-color: #f3f4f6 !important;
}
